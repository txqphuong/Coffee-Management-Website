CREATE DATABASE QLCAPHE_WEB
Go
USE QLCAPHE_WEB
Go

CREATE TABLE NHANVIEN
(
	MANV INT PRIMARY KEY identity,
	TENNV NVARCHAR(50),
	GIOITINH NVARCHAR(10),
	NGAYSINH DATE,
	SDT VARCHAR(10),
	CHUCVU NVARCHAR(30)
)
Go

CREATE TABLE KHACHHANG
(
	MAKH INT PRIMARY KEY identity,
	TENNKH NVARCHAR(50),
	PHAI NVARCHAR(10),
	SDTKH VARCHAR(10),
	TENTAIKHOAN NVARCHAR(50),
	MATKHAUTK VARCHAR(20),
	DIACHIKH NVARCHAR(50),
	EMAIL VARCHAR(30),
)
Go

CREATE TABLE TAIKHOAN
(
	MANV INT,
	TenNguoiDung NVARCHAR(50) PRIMARY KEY,
	MatKhau CHAR(20),
	CONSTRAINT FK_MANV_TAIKHOAN FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
)
Go

CREATE TABLE HOADON
(
	MAHD INT PRIMARY KEY identity,
	MAKH INT,
	MANV INT,
	NGAYBAN DATE,
	TONGTIEN FLOAT,
	SOBAN INT,
	CONSTRAINT FK_MAKH_HOADON FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH),
	CONSTRAINT FK_MANV_HOADON FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
)
Go

CREATE TABLE LOAI
(
	MALOAI INT PRIMARY KEY identity,
	TENLOAI NVARCHAR(50)
)
Go

CREATE TABLE SANPHAM
(
	MASP INT PRIMARY KEY identity,
	MALOAI INT,
	TENSP NVARCHAR(50),
	GIABAN FLOAT,
	HINHANH nvarchar(50),
	CONSTRAINT FK_MALOAI_SANPHAM FOREIGN KEY(MALOAI) REFERENCES LOAI(MALOAI)
)
GO

CREATE TABLE CHITIETHD
(
	MASP INT,
	MAHD INT,
	SOLUONG INT,
	THANHTIEN FLOAT,
	CONSTRAINT PK_MAHD_MASP_CHITIETHD PRIMARY KEY(MASP,MAHD),
	CONSTRAINT FK_MAHD_CHITIETHD FOREIGN KEY(MAHD) REFERENCES HOADON(MAHD),
	CONSTRAINT FK_MASP_CHITIETHD FOREIGN KEY(MASP) REFERENCES SANPHAM(MASP)
)
Go

CREATE TABLE KHUYENMAI
(
	MaKM INT PRIMARY KEY identity,
	TenSuKien NVARCHAR(50) ,
	NoiDung NVARCHAR(50),
	TangSP NVARCHAR(50),
	NgayBD DATE,
	NgayKT DATE,
	TiLeKM float
)
GO

CREATE TABLE DUOCKM
(
	MaKM INT not null, 
	MaSP INT not null,
	CONSTRAINT FK_MaKM_DUOCKM FOREIGN KEY (MaKM) REFERENCES KHUYENMAI(MaKM),
	CONSTRAINT FK_MaSP_DUOCKM FOREIGN KEY (MaSP) REFERENCES SANPHAM(MASP)
)
GO
ALTER TABLE DUOCKM ADD CONSTRAINT PK_MaKM_MaSP_DUOCKM PRIMARY KEY (MaKM,MaSP)
GO

CREATE TABLE NGUYENLIEU
(
	MaNL INT PRIMARY KEY identity,
	TenNL NVARCHAR(30),
	SoLuongCon INT,
	DVT NVARCHAR(30),
	DonGia float,
	HanSD DATE
)
GO

CREATE TABLE PHACHE
(
	MaSP INT not null,
	MaNL INT not null,
	FOREIGN KEY (MaSP) REFERENCES SANPHAM(MASP),
	FOREIGN KEY (MaNL) REFERENCES NGUYENLIEU(MaNL),
)
GO
ALTER TABLE PHACHE ADD CONSTRAINT PK_PHACHE PRIMARY KEY(MaSP,MaNL)
GO

CREATE TABLE NHACC
(
	MANCC INT PRIMARY KEY identity,
	TENNHACC NVARCHAR(50),
	SDTNHACCC VARCHAR(10),
	DIACHINHACC NVARCHAR(50)
)
GO

CREATE TABLE HOADONNHAP
(
	MAHDNHAP INT PRIMARY KEY identity,
	MANCC INT,
	MANV INT,
	TONGTIENNHAP FLOAT,
	NGAYNHAP DATE,
	GHICHU NVARCHAR(50),
	CONSTRAINT FK_MANCC_HOADONNHAP FOREIGN KEY (MANCC) REFERENCES NHACC(MANCC),
	CONSTRAINT FK_MANV_HOADONNHAP FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV),
)
GO

CREATE TABLE CHITIETHDNHAP
(
	MANL INT,
	MAHDNHAP INT,
	SOLUONGHANGNHAP INT,
	THANHTIENCTHDNHAP FLOAT,
	CONGNO float,
	CONSTRAINT PK_MANL_MAHDNHAP_CHITIETHDNHAP PRIMARY KEY (MANL,MAHDNHAP),
	CONSTRAINT FK_MANL_CHITIETHDNHAP FOREIGN KEY(MANL) REFERENCES NGUYENLIEU(MaNL),
	CONSTRAINT FK_MAHDNHAP_CHITIETHDNHAP FOREIGN KEY(MAHDNHAP) REFERENCES HOADONNHAP(MAHDNHAP)
)
GO

SET DATEFORMAT DMY
INSERT INTO NHANVIEN(TENNV,GIOITINH,NGAYSINH,SDT,CHUCVU) VALUES
(N'Trần Xuân Quỳnh Phương',N'Nữ','01/01/2002','0123456789',N'Quản lý'),
(N'Đỗ Huệ Mẫn',N'Nữ','02/03/2002','0123456987',N'NV Partime'),
(N'Trần Đức Huy',N'Nam','03/04/2001','0123456879',N'NV Fulltime'),
(N'Nguyễn Hoàng Ân',N'Nữ','04/05/2000','0123654789',N'NV Fulltime'),
(N'Nguyễn Xuân Quỳnh',N'Nữ','05/06/2001','0123546789',N'NV Partime'),
(N'Nguyễn Nhật Nam',N'Nam','05/08/2001','0123583178',N'NV Fulltime'),
(N'Nguyễn Xuân Quỳnh',N'Nữ','05/06/2001','0123546789',N'NV Partime'),
(N'Nguyễn Văn An',N'Nam','09/12/2000','0123546749',N'NV Partime'),
(N'Lê Quốc Bình',N'Nam','05/09/2002','0123546458',N'NV Partime'),
(N'Nguyễn Thanh Nhã',N'Nam','25/07/2000','0945754678',N'NV Fulltime'),
(N'Nguyễn Thị Nguyệt',N'Nữ','25/07/2002','0945755558',N'NV Fulltime'),
(N'Trần Văn Sang',N'Nam','25/11/2001','0945754652',N'NV Fulltime')
go

INSERT INTO KHACHHANG(TENNKH,PHAI,SDTKH,TENTAIKHOAN,MATKHAUTK,DIACHIKH,EMAIL) VALUES
(N'Nguyễn Hải Yến',N'Nữ','0909400434','nguyenhaiyen123','nhy123',N'TP.HCM','nguyenhaiyen1@gmail.com'),
(N'Trương Mạnh Hùng',N'Nam','0909467434','truongmanhhung221','tmh222',N'Bình Dương','truongmanhhung2@gmail.com'),
(N'Đào Minh Châu',N'Nữ','0909469434','daominhchau20','dmc201',N'TP.HCM','daominhchau2012@gmail.com'),
(N'Bùi Văn Cáp',N'Nam','0912469434','buivancap000','bvc200',N'TP.HCM','buivancap2234@gmail.com'),
(N'Nguyễn Thị Thanh Thúy',N'Nữ','0952469434','nguyenthanhthuy091','ntt1',N'TP.HCM','nguyenthanhthuy111@gmail.com')
go

INSERT INTO TAIKHOAN(MANV,TenNguoiDung,MatKhau) VALUES
('1','QUYNHPHUONG','123456'),
('2','HUEMAN','234567'),
('3','DUCHUY','345678'),
('4','HOANGAN','456789'),
('5','XQUYNHPHUONG','567890')
go

SET DATEFORMAT DMY
INSERT INTO HOADON(MAKH,MANV,NGAYBAN,TONGTIEN, SOBAN) VALUES 
('3','2','01/09/2022',31000,7),
('4','4','01/07/2022',31000,7),
('5','2','13/09/2022',10000,4),
('3','1','15/11/2022',30000,3),
('4','5','03/08/2022',29000,6),
('5','3','07/08/2022',34000,8),
('4','5','25/09/2022',31000,7),
('5','4','23/09/2022',10000,4),
('3','3','18/11/2022',30000,3),
('4','2','03/12/2022',29000,6),
('5','4','27/08/2022',34000,8),
('1','5','25/10/2022',31000,1),
('2','4','26/10/2022',10000,2),
('3','3','25/11/2022',30000,3),
('4','2','24/12/2022',29000,6),
('5','4','27/7/2022',34000,8)
go

INSERT INTO LOAI(TENLOAI) VALUES
(N'Thức uống'),
(N'Thức ăn')
go

INSERT INTO SANPHAM(MALOAI,TENSP,GIABAN,HINHANH) VALUES --1 nước uống, 2 đồ ăn
('1',N'Cà phê đen',10000,'HINH1.JPG'),
('1',N'Cà phê sữa',14000,'HINH2.JPG'),
('1',N'Sữa tươi cà phê',17000,'HINH3.JPG'),
('1',N'Cà phê sữa Hazelnut',14000,'HINH4.JPG'),
('1',N'Cà phê đá xay Frappuchino',17000,'HINH5.JPG'),
('1',N'Cà phê Capuchino',12000,'HINH6.JPG'),
('1',N'Trà sữa truyền thống',15000,'HINH7.JPG'),
('1',N'Trà sữa thái xanh',20000,'HINH8.JPG'),
('1',N'Trà sữa thái đỏ',20000,'HINH9.JPG'),
('1',N'Trà sữa ô long',25000,'HINH10.JPG'),
('2',N'Bánh mì ốp la',25000,'HINH11.JPG'),
('2',N'Bánh mì xíu mại',35000,'HINH12.JPG'),
('2',N'Bánh donut',25000,'HINH13.JPG'),
('2',N'Bánh sữa dừa',30000,'HINH14.JPG'),
('2',N'Bông lan trứng muối',55000,'HINH15.JPG'),
('2',N'Bánh lava trà xanh',35000,'HINH16.JPG'),
('2',N'Bánh cookie chocomint',25000,'HINH17.JPG')
go

select * from CHITIETHD

INSERT INTO CHITIETHD(MASP,MAHD,SOLUONG,THANHTIEN) VALUES
('4','1',1,14000),
('5','1',1,17000),
('1','2',1,10000),
('5','4',1,17000),
('7','3',2,30000),
('6','4',1,12000),
('3','5',2,34000)
GO

SET DATEFORMAT DMY
INSERT INTO KHUYENMAI(TenSuKien,NoiDung,TangSP,NgayBD,NgayKT) VALUES
(N'Lễ VALENTINE',N'Chúc quý khách 1 ngày hạnh phúc',N'Tặng một ly CÀ PHÊ SỮA HAZELNUT','14/2/2022','15/2/2022'),
(N'Lễ Giáng Sinh',N'Chúc quý khách một mùa Giáng Sinh vui vẻ',N'Tặng một ly CÀ PHÊ SỮA PHONG CÁCH','25/12/2002','26/12/2022'),
(N'Tết Dương Lịch',N'Chúc quý khách một năm mới bình an',N'Tặng một ly CÀ PHÊ SỮA SÀNH ĐIỆU','1/1/2022','2/1/2022'),
(N'Mừng Ngày Quốc Tế Lao Động',N'Lao động là vinh quang',N'Tặng một ly CÀ PHÊ ĐÁ TRUYỀN THỐNG','30/4/2022','1/5/2022')
GO

INSERT INTO DUOCKM(MaKM,MaSP) VALUES
('1','4'),
('2','5'),
('3','7'),
('4','1')
GO

INSERT INTO NGUYENLIEU(TenNL,SoLuongCon,DVT,DonGia,HanSD) VALUES
(N'Cà phê Arabica',50,N'KG',100000,'01/01/2024'),
(N'Cà phê Robusta',70,N'KG',100000,'02/01/2025'),
(N'Sữa Vinamilk',10,N'Thùng',110000,'01/03/2024'),
(N'TH True Milk',12,N'Thùng',120000,'01/08/2025'),
(N'Đường',20,N'KG',20000,'01/09/2025'),
(N'Trà đen',20,N'KG',50000,'01/09/2024'),
(N'Trà thái xanh',20,N'KG',40000,'01/10/2025'),
(N'Trà thái đỏ',10,N'KG',35000,'01/04/2025'),
(N'Bột làm bánh',15,N'KG',80000,'01/04/2025'),
(N'Trứng muối',5,N'KG',70000,'01/04/2024')
Go

INSERT INTO PHACHE(MaSP,MaNL) VALUES
('4','1'),
('4','4'),
('5','2'),
('5','4'),
('7','3'),
('1','4')
Go

INSERT INTO NHACC(TENNHACC,SDTNHACCC,DIACHINHACC) VALUES
(N'BakerLand','0947973484',N'Cách Mạng Tháng 8, Q4, TPHCM'),
(N'Sơn Việt coffe','0911395301',N'Kinh Đ.Dương, phường 13, Q6, TPHCM'),
(N'Buôn mê coffe','0858424288',N'Bình Trị Đông A, Bình Tân, TPHCM'),
(N'LOTHAMILK','0123418262',N'16, Nguyễn Thị Trần, phường 3, Q8, TPHCM'),
(N'CTCP Sữa Việt Nam','0834348821',N'10 Tân Trào, phường Tân Phú, Q7, TPHCM')
Go

SET DATEFORMAT DMY
INSERT INTO HOADONNHAP(MANCC,MANV,TONGTIENNHAP,NGAYNHAP,GHICHU) VALUES
('1','2',1580000,'25/10/2022',N'Đã thanh toán'),
('3','3',1625000,'25/9/2022',N'Còn nợ')
Go

INSERT INTO CHITIETHDNHAP(MANL,MAHDNHAP,SOLUONGHANGNHAP,THANHTIENCTHDNHAP,CONGNO) VALUES
('1','1',5,500000,0),
('2','1',3,300000,0),
('5','1',5,400000,0),
('6','1',6,300000,0),
('7','1',2,80000,0),
('3','2',5,550000,550000),
('4','2',3,360000,360000),
('8','2',5,175000,0),
('9','2',5,400000,0),
('10','2',2,140000,140000)
Go








